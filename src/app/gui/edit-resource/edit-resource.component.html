<!-- Title + actions -->
<header class="main-header mb-0">
  <div class="main-content pb-0">
    <div class="row align-items-end justify-content-between mb-0">
      <div class="col-auto mb-3">
        <h1 *ngIf="onEdit==='new'" class="main-title">Create Resource</h1>
        <h1 *ngIf="onEdit==='edit'" class="main-title">{{user.firstName}} {{user.lastName}}</h1>
      </div>
      <div class="col-auto mb-3">
        <a class="btn btn-basic mr-2" routerLink=".."> Cancel </a>
        <ng-container *ngIf="isResourceAdministrated">
          <button (click)="onSubmit()" *ngIf="onEdit === 'edit'" class="btn btn-primary" type="submit"> Save
          </button>
          <button (click)="onSubmit()" *ngIf="onEdit === 'new'" class="btn btn-primary" type="submit"> Create
          </button>
        </ng-container>
      </div>
    </div>
  </div>
</header>

<!-- Search + Generate -->
<header class="main-header mb-2" *ngIf="onEdit === 'edit'" >
  <div class="main-content pb-0">
    <div class="row align-items-end justify-content-between mb-0">
      <div class="col-auto mb-3">
        <div>
          <div class="input-group">
            <select [ngModel]="selectedContract"
                    (change)="contractChange($event)"
                    class="form-control custom-select"
                    id="contractPeriod"
                    name="contractPeriod">
              <option *ngFor="let contract of contractList" [ngValue]="contract">
                From {{contract.startDate}} To {{!contract.endDate ? 'PRESENT' : contract.endDate}}
              </option>
            </select>
            <div *ngIf="this.hasAdminRole" class="input-group-append">
              <button (click)="newContractClick()" class="btn btn-primary">New</button>
            </div>
          </div>
        </div>
      </div>
      <div class="col-auto mb-3" *ngIf="onEdit === 'edit' && this.companyService.luxCompanies.includes(this.selectedContract.company) && isResourceAdministrated">
        <a type="button" class="btn btn-basic text-center dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Generate documents</a>
        <div class="dropdown-menu" style="min-width: 12.6rem; cursor: pointer;">
          <a class="dropdown-item" (click)="openGenerateCertificateModal()">Working certificate</a>
          <a class="dropdown-item" (click)="generateCarPolicy()">Car policy</a>
        </div>
      </div>
    </div>
  </div>
</header>

<section class="main-content">

  <!-- Main navtabs -->
  <div class="main-nav-tabs">

    <!-- nav tabs -->
    <ul class="nav nav-tabs" id="myTab" role="tablist">

      <li class="nav-item"><a aria-controls="profile" aria-selected="true" class="nav-link active" #firstTab
                              data-toggle="tab" href="#personal-information" id="personal-information-tab"
                              role="tab">Personal Information</a></li>

      <li class="nav-item"><a aria-controls="profile" aria-selected="false" class="nav-link"
                              data-toggle="tab" href="#contact" id="contact-tab"  [class.disabled-a]="(onEdit === 'edit' && this.selectedContract && this.selectedContract.historizedResource) || (hasAdminRole && !isResourceAdministrated)"
                              role="tab">Contacts</a></li>

      <li class="nav-item" *ngIf="isResourceAdministrated"><a aria-controls="profile" aria-selected="false" class="nav-link"
                              data-toggle="tab" href="#emergency-contact" id="emergency-contact-tab"
                              [class.disabled-a]="onEdit === 'edit' && this.selectedContract && this.selectedContract.historizedResource"
                              role="tab">Emergency Contacts</a></li>

      <li class="nav-item"><a aria-controls="profile" aria-selected="false" class="nav-link"  [class.disabled-a]="(onEdit === 'edit' && this.selectedContract && this.selectedContract.historizedResource) || (hasAdminRole && !isResourceAdministrated)"
                              data-toggle="tab" href="#personal-usage-policy" id="personal-usage-policy-tab"
                              role="tab">Personal usage policy</a></li>
      <li *ngIf="this.hasReadAllOrAdminRole ||  isResourceAdministrated" class="nav-item"><a aria-controls="profile" aria-selected="false"
                                                                 class="nav-link"
                                                                 data-toggle="tab" href="#security-clearance"
                                                                 id="security-clearance-tab"  [class.disabled-a]="onEdit === 'edit' && this.selectedContract && this.selectedContract.historizedResource"
                                                                 role="tab">Security clearance</a></li>
      <li class="nav-item"><a aria-controls="profile" aria-selected="false" class="nav-link"
                              data-toggle="tab" href="#onboarding" id="onboarding-tab"  [class.disabled-a]="(onEdit === 'edit' && this.selectedContract && this.selectedContract.historizedResource) || (hasAdminRole && !isResourceAdministrated)"
                              role="tab">Onboarding</a></li>

      <li class="nav-item" *ngIf="onEdit === 'edit'">
        <a aria-controls="profile" aria-selected="false" [class.disabled-a]="(onEdit === 'edit' && this.selectedContract && this.selectedContract.historizedResource) || (hasAdminRole && !isResourceAdministrated)" class="nav-link"
                              data-toggle="tab" href="#badge" id="badge-tab"
                              role="tab">Badge
        </a>
      </li>
      <li class="nav-item" *ngIf="onEdit === 'edit'">
        <a aria-controls="profile" aria-selected="false" [class.disabled-a]="(onEdit === 'edit' && this.selectedContract && this.selectedContract.historizedResource) || (hasAdminRole && !isResourceAdministrated)" class="nav-link"
                              data-toggle="tab" href="#phone" id="phone-tab"
                              role="tab">Phone
        </a>
      </li>

      <li class="nav-item">
        <a aria-controls="frontier worker declaration" aria-selected="false" [class.disabled-a]="!(socialConsent.value === true && displayFrontierFields)" class="nav-link"
                              data-toggle="tab" href="#frontier" id="frontier-tab"
                              role="tab">Frontier worker declaration
        </a>
      </li>
    </ul>

    <!-- tab content -->
    <div class="tab-content bg-white" id="myTabContent">

      <!-- Tab Personal Information -->
      <section aria-labelledby="personal-information-tab" class="tab-pane fade show active"
               id="personal-information"
               role="tabpanel">
        <div class="box mx-0 pt-4">
          <div class="row border-bottom">
            <div class="col-12 col-sm-6 pt-4">
              <header>
                <h2 class="mb-3">Information</h2>
              </header>

              <div class="p-3">
                <form [formGroup]="informationForm" action="#" class="row">

                  <div class="form-group col-sm-12 col-lg-4">
                    <div class="row" style="justify-content: center">
                      <div class="form-group col-sm-12 col-lg-12">
                        <img alt="" class="employees-information-avatar"
                             [src]="croppedPicture">
                      </div>
                    </div>
                    <div *ngIf="isResourceAdministrated && (!this.selectedContract || !this.selectedContract.historizedResource)" class="row flex-column">
                      <div class="col mb-3">
                        <button (click)="uploadPicture()" class="btn btn-secondary py-2 btn-block"
                                type="button"><i aria-hidden="true" class="fas fa-upload fa-sm pr-2"></i>Upload
                        </button>
                      </div>
                      <div class="col">
                        <button (click)="loadPictureInCropper()" class="btn btn-primary py-2 btn-block"
                                data-target="#editProfilePicture"
                                data-toggle="modal" id="editModalButton" type="button">
                          <i class="fa fa-pencil" aria-hidden="true"></i> Edit
                        </button>
                      </div>
                    </div>
                    <input (change)="fileChangeEvent($event)" accept=".jpg,.jpeg,.png,.PNG" id="pictureUpload"
                           style="display: none;"
                           type="file">
                  </div>

                  <div class="form-group col-sm-12 col-lg-8">
                    <div class="row align-items-end">
                      <div class="form-group col-sm-12 col-lg-6">
                        <label for="firstName">First name
                          <small class="text-muted">(required)</small>
                        </label>
                        <input class="form-control" formControlName="firstName" id="firstName" placeholder="First name"
                               (ngModelChange)="generateAccountFromNames()" maxlength="101" type="text">
                        <div *ngIf="firstName.invalid && (firstName.dirty || firstName.touched)"
                             class="invalid-feedback">
                          <div *ngIf="firstName.errors?.required">
                            First name is required
                          </div>
                          <div *ngIf="firstName.errors?.maxlength">
                            First name size must not exceed 100 characters
                          </div>
                        </div>
                      </div>
                      <div class="form-group col-sm-12 col-lg-6">
                        <label for="lastName">Last name
                          <small class="text-muted">(required)</small>
                        </label>
                        <input class="form-control" formControlName="lastName" id="lastName" placeholder="Last name"
                               (ngModelChange)="generateAccountFromNames()" maxlength="101" type="text">
                        <div *ngIf="lastName.invalid && (lastName.dirty || lastName.touched)" class="invalid-feedback">
                          <div *ngIf="lastName.errors?.required">
                            Last name is required
                          </div>
                          <div *ngIf="lastName.errors?.maxlength">
                            Last name size must not exceed 100 characters
                          </div>
                        </div>
                      </div>
                      <div class="form-group col-sm-12 col-lg-6">
                        <label for="account">Account
                          <small class="text-muted">(required)</small>
                        </label>
                        <input class="form-control" formControlName="account" id="account" placeholder="Account"
                               maxlength="9" type="text"/>
                        <div *ngIf="account.invalid && (account.dirty || account.touched)" class="invalid-feedback">
                          <div *ngIf="account.errors?.required">
                            Account is required
                          </div>
                          <div *ngIf="account.errors?.maxlength">
                            Account size must not exceed 8 characters
                          </div>
                        </div>
                        <div *ngIf="accountIsAlreadyUsedByResource" class="invalid-feedback">
                          <div class="text-warning">
                            Account already used by a resource
                          </div>
                        </div>
                      </div>
                      <div class="form-group col-sm-12 col-lg-6">
                        <label class="label-ro">Gender </label>
                        <select class="form-control custom-select" formControlName="gender" id="gender"
                                name="gender">
                          <option value="">Select a gender</option>
                          <option value="M">M</option>
                          <option value="F">F</option>
                          <option value="O">Other</option>
                        </select>
                      </div>
                    </div>
                    <div class="row">
                      <ng-container *ngIf="this.hasReadAllOrAdminRole || hasReadAccessToResource || (this.hasAdminRole && isResourceAdministrated)">
                        <div class="form-group col-sm-12 col-lg-6">
                          <label for="birthDate">Birth date </label>
                          <div class="input-group">
                            <input #dp="ngbDatepicker" [footerTemplate]="footerTemplate1"
                                   class="form-control" formControlName="birthDate" id="birthDate"
                                   maxlength="20" ngbDatepicker
                                   [minDate]="{year: 1950, month: 1, day: 1}"
                                   placeholder="DD/MM/YYYY" type="text"/>
                            <div *ngIf="isResourceAdministrated" class="input-group-append">
                              <button (click)="dp.toggle()" class="btn btn-basic btn-icon fa fa-calendar"
                                      type="button"></button>
                            </div>
                          </div>
                          <ng-template #footerTemplate1>
                            <hr class="my-0">
                            <button (click)="birthDate.setValue(today); dp.close()"
                                    class="btn btn-primary btn-sm m-2 float-left">Today
                            </button>
                            <button (click)="dp.close()" class="btn btn-secondary btn-sm m-2 float-right">Close</button>
                          </ng-template>
                          <div *ngIf="birthDate.invalid && (birthDate.dirty||birthDate.touched)"
                               class="invalid-feedback">
                            <div *ngIf="birthDate.errors.ngbDate?.invalid">
                              Birth date must be correct and in the following format : DD/MM/YYYY
                            </div>
                          </div>
                        </div>
                        <div class="form-group col-sm-12 col-lg-6">
                          <ng-template #rtCountry let-r="result.countryName" let-t="term">
                            <ngb-highlight [result]="r" [term]=""></ngb-highlight>
                          </ng-template>
                          <label for="country">Nationality</label>
                          <input
                            #instanceNationality="ngbTypeahead"
                            (click)="clickNationality.next($event.target.value)"
                            (focusout)="checkCountryValue()"
                            [inputFormatter]="formatterCountry"
                            [ngbTypeahead]="searchNationality"
                            [resultTemplate]="rtCountry"
                            class="form-control"
                            formControlName="country"
                            id="country"
                            maxlength="41"
                            placeholder="Country"
                            type="text"
                          />
                          <div *ngIf="(country.dirty || country.touched)"
                               class="invalid-feedback">
                            <div *ngIf="country.value && !country.value.countryCode">
                              Country must be selected from the list.
                            </div>
                          </div>
                        </div>

                        <div class="form-group col-6">
                          <label for="resCountry">Residential country
                            <small class="text-muted" *ngIf="isResidentialCountryRequired()">(required)</small>
                          </label>
                          <ng-template #rcCountry let-r="result.countryLabel" let-t="term">
                            <ngb-highlight [result]="r" [term]=""></ngb-highlight>
                          </ng-template>
                          <input
                            #instanceResCountry="ngbTypeahead"
                            (click)="clickResCountry.next($event.target.value)"
                            (focusout)="checkResidentialCountryValue()"
                            [inputFormatter]="formatterResidentialCountry"
                            [ngbTypeahead]="searchResidentialCountry"
                            [resultTemplate]="rcCountry"
                            class="form-control"
                            formControlName="resCountry"
                            id="resCountry"
                            maxlength="41"
                            placeholder="Country"
                            type="text"
                          />
                          <div *ngIf="(residentialCountry.dirty || residentialCountry.touched)"
                               class="invalid-feedback">
                            <div *ngIf="residentialCountry.errors?.required">
                              Residential country is required.
                            </div>
                            <div *ngIf="residentialCountry.value && !residentialCountry.value.countryCode">
                              Residential country must be selected from the list.
                            </div>
                          </div>
                        </div>
                        <div class="form-group col-sm-12 col-lg-6"></div>
                        <div class="form-group col-sm-12 col-lg-6" *ngIf="displayFrontierFields">
                          <label for="socialConsent">Consent to declare data to social security authorities</label>
                          <select class="form-control custom-select" formControlName="socialConsent" id="socialConsent"
                                  name="socialConsent"  [disabled]="!isResourceAdministrated">
                            <option *ngFor="let response of SOCIAL_CONSENT_RESPONSES" [ngValue]="response.value">
                              {{response.displayValue}}
                            </option>
                          </select>
                        </div>
                        <div class="form-group col-6" *ngIf="displaySocialSecurityNumber">
                          <label class="label-ro" for="socialSecurityNumber">
                            Social security number (residential country)
                          </label>
                          <input class="form-control" formControlName="socialSecurityNumber" id="socialSecurityNumber"
                                 placeholder="Social security number"
                                 [readOnly]="!isResourceAdministrated"
                                 maxlength="255" type="text"/>
                        </div>

                        <div class="form-group col-sm-12 col-lg-12">
                          <label class="label-ro" for="informationComment">Comment </label>
                          <textarea class="form-control" formControlName="comment" id="informationComment"
                                    name="informationComment" placeholder="Comment" rows="5"></textarea>
                        </div>
                        <ng-template #employeeAccount let-r="result" let-t="term">
                          <ngb-highlight [result]="r.lastName + ' ' + r.firstName + ' (' + r.account + ')'"
                                         [term]=""></ngb-highlight>
                        </ng-template>
                        <div class="form-group col-sm-12 col-lg-12">
                          <label for="manager">Manager</label>
                          <input
                            #instanceManager="ngbTypeahead"
                            (click)="clickManager$.next($event.target.value)"
                            [inputFormatter]="formatterEmployee"
                            [ngbTypeahead]="searchManager"
                            [resultTemplate]="employeeAccount"
                            [readOnly]="!isResourceAdministrated"
                            class="form-control"
                            formControlName="manager"
                            id="manager"
                            type="text"
                          />
                          <div *ngIf="manager.invalid && (manager.dirty || manager.touched)" class="invalid-feedback">
                            <div *ngIf="manager.errors.notInList">
                              Please select a valid manager.
                            </div>
                          </div>
                        </div>
                        <div class="col-12">
                          <div class="row align-items-end">
                            <div class="form-group col-sm-12 col-lg-6">
                              <div class="form-check">
                                <input class="form-check-input" formControlName="partOfReferral" id="isPartOfReferral"
                                       (change)="referrerEvent($event)" name="isPartOfReferral" type="checkbox"/>
                                <label for="isPartOfReferral">Part of referral program</label>
                              </div>
                            </div>
                            <ng-template #rt let-r="result" let-t="term">
                              <ngb-highlight [result]="r.name"
                                             [term]=""></ngb-highlight>
                            </ng-template>

                            <div class="form-group col-sm-12 col-lg-6">
                              <label for="referrer">Referrer</label>
                              <input
                                #instanceReferrer="ngbTypeahead"
                                (click)="clickReferrer$.next($event.target.value)"
                                [inputFormatter]="formatter"
                                [ngbTypeahead]="searchReferrer"
                                [resultTemplate]="rt"
                                class="form-control"
                                formControlName="referrer"
                                id="referrer"
                                placeholder="Referrer"
                                type="text"
                              />
                            </div>
                          </div>
                        </div>
                        <ng-container *ngIf="type.value == 'empl' || type.value == 'overh'">
                          <div class="col-12">
                            <div class="row align-items-end">
                              <div class="form-group col-sm-12 col-lg-6 checkbox-col">
                                <div class="form-check">
                                  <input class="form-check-input" formControlName="medicalCheck" id="medicalCheck"
                                         name="medicalCheck" type="checkbox"/>
                                  <label for="medicalCheck">Medical check-up done</label>
                                </div>
                              </div>
                              <div class="form-group col-sm-12 col-lg-6">
                                <label for="medicalCheckDate">Medical check-up validity date</label>
                                <div class="input-group">
                                  <input #dpmc="ngbDatepicker" [footerTemplate]="footerTemplate1"
                                         class="form-control" formControlName="medicalCheckEndDate" id="medicalCheckDate"
                                         maxlength="20" ngbDatepicker
                                         [minDate]="{year: 1950, month: 1, day: 1}"
                                         placeholder="Medical check-up validity date" type="text"/>
                                  <div *ngIf="isResourceAdministrated" class="input-group-append">
                                    <button (click)="dpmc.toggle()" [disabled]="medicalCheckEndDate.disabled" class="btn btn-basic btn-icon fa fa-calendar"
                                            type="button"></button>
                                  </div>
                                </div>
                                <ng-template #footerTemplate1>
                                  <hr class="my-0">
                                  <button (click)="medicalCheckEndDate.setValue(today); dpmc.close()"
                                          class="btn btn-primary btn-sm m-2 float-left">Today
                                  </button>
                                  <button (click)="dpmc.close()" class="btn btn-secondary btn-sm m-2 float-right">Close</button>
                                </ng-template>
                                <div *ngIf="medicalCheckEndDate.invalid && (medicalCheckEndDate.dirty||medicalCheckEndDate.touched)"
                                     class="invalid-feedback">
                                  <div *ngIf="medicalCheckEndDate.errors.ngbDate?.invalid">
                                    Medical check-up validity date must be correct and in the following format : DD/MM/YYYY
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </ng-container>
                      </ng-container>
                    </div>
                  </div>

                </form>

              </div>
            </div>

            <div class="col-12 col-sm-6 pt-4 border-left">

              <!-- Contract details div -->
              <header>
                <h2 class="mb-3">Contract details</h2>
              </header>

              <div class="p-3">
                <form [formGroup]="contractDetailsForm" action="#" class="row">

                  <div class="form-group col-sm-12 col-lg-6">
                    <label for="contractType">Type
                      <small class="text-muted">(required)</small>
                    </label>
                    <select class="form-control custom-select" formControlName="type" id="contractType"
                            name="contractType" (change)="onResourceTypeChange($event.target.value)">
                      <option *ngFor="let type of this.formData.jobtypes" value="{{type.description}}">
                        {{type.jobType | uppercase}}
                      </option>
                    </select>
                    <div *ngIf="type.errors?.required">
                      Type is required
                    </div>
                  </div>

                  <div class="form-group col-sm-12 col-lg-6">
                    <label for="contractCompany">Company
                      <small class="text-muted">(required)</small>
                    </label>
                    <select class="form-control custom-select" formControlName="company" id="contractCompany"
                            name="contractCompany" (change)="updateResidentialCountryValidity()">
                      <option *ngFor="let company of this.companyList" value="{{company}}">
                        {{company | uppercase}}
                      </option>
                    </select>
                    <div *ngIf="company.errors?.required">
                      Company is required
                    </div>
                  </div>

                  <div class="form-group col-sm-12 col-lg-6">
                    <label for="contractStartDate">Start date
                      <small class="text-muted">(required)</small>
                    </label>
                    <div class="input-group">
                      <input #dstr="ngbDatepicker" [footerTemplate]="footerTemplate3" class="form-control"
                             formControlName="start" id="contractStartDate" maxlength="20"
                             [minDate]="{year: 2000, month: 1, day: 1}"
                             ngbDatepicker placeholder="DD/MM/YYYY" type="text"/>
                      <div *ngIf="isResourceAdministrated" class="input-group-append">
                        <button (click)="dstr.toggle()" class="btn btn-basic btn-icon fa fa-calendar"
                                type="button"></button>
                      </div>
                      <div *ngIf="startDate.invalid && (startDate.dirty||startDate.touched)" class="invalid-feedback">
                        <div *ngIf="startDate.errors.ngbDate?.invalid">
                          Start date must be correct and in the following format : DD/MM/YYYY
                        </div>
                        <div *ngIf="startDate.errors.required">
                          Start date is required
                        </div>
                      </div>
                    </div>
                    <ng-template #footerTemplate3>
                      <hr class="my-0">
                      <button (click)="startDate.setValue(today); dstr.close()"
                              class="btn btn-primary btn-sm m-2 float-left">Today
                      </button>
                      <button (click)="dstr.close()" class="btn btn-secondary btn-sm m-2 float-right">Close</button>
                    </ng-template>
                  </div>

                  <div class="form-group col-sm-12 col-lg-6">
                    <label for="endDate">End date</label>
                    <div class="input-group">
                      <input #dend="ngbDatepicker" [footerTemplate]="footerTemplate4" class="form-control"
                             formControlName="end" id="endDate" maxlength="20"
                             [minDate]="{year: 2000, month: 1, day: 1}"
                             ngbDatepicker placeholder="DD/MM/YYYY" type="text"/>
                      <div *ngIf="isResourceAdministrated" class="input-group-append">
                        <button (click)="dend.toggle()" class="btn btn-basic btn-icon fa fa-calendar"
                                type="button"></button>
                      </div>
                    </div>
                    <ng-template #footerTemplate4>
                      <hr class="my-0">
                      <button
                        (click)="endDate.setValue(today); endDate.markAsDirty(); endDate.markAsTouched(); dend.close()"
                        class="btn btn-primary btn-sm m-2 float-left">Today
                      </button>
                      <button (click)="dend.close()" class="btn btn-secondary btn-sm m-2 float-right">Close</button>
                    </ng-template>
                    <div *ngIf="endDate.invalid && (endDate.dirty||endDate.touched)" class="invalid-feedback">
                      <div *ngIf="endDate.value && endDate.value !== '' && (endDate.errors?.format ||
                        endDate.errors.ngbDate?.invalid)">
                        End date must be correct and in the following format : DD/MM/YYYY
                      </div>
                      <div *ngIf="endDate.errors?.min">
                        Date must be superior to 01/01/2000
                      </div>
                    </div>
                  </div>
                  <ng-container *ngIf="this.hasReadAllOrAdminRole || hasReadAccessToResource || (this.hasAdminRole && isResourceAdministrated)">

                    <div class="form-group col-sm-12 col-lg-6">
                      <label for="endProbation">End of probation</label>
                      <div class="input-group">
                        <input #dendProb="ngbDatepicker" [footerTemplate]="footerTemplateEndOfProbation" class="form-control"
                               formControlName="endProbation" id="endProbation" maxlength="20"
                               [minDate]="{year: 2000, month: 1, day: 1}"
                               ngbDatepicker placeholder="DD/MM/YYYY" type="text"/>
                        <div *ngIf="isResourceAdministrated" class="input-group-append">
                          <button (click)="dendProb.toggle()" class="btn btn-basic btn-icon fa fa-calendar"
                                  type="button"></button>
                        </div>
                      </div>
                      <ng-template #footerTemplateEndOfProbation>
                        <hr class="my-0">
                        <button
                          (click)="endProbation.setValue(today); endProbation.markAsDirty(); endProbation.markAsTouched(); dendProb.close()"
                          class="btn btn-primary btn-sm m-2 float-left">Today
                        </button>
                        <button (click)="dendProb.close()" class="btn btn-secondary btn-sm m-2 float-right">Close</button>
                      </ng-template>
                      <div *ngIf="endProbation.invalid && (endProbation.dirty||endProbation.touched)" class="invalid-feedback">
                        <div *ngIf="endProbation.value && endProbation.value !== '' && (endProbation.errors?.format ||
                          endProbation.errors.ngbDate?.invalid)">
                          End of probation must be correct and in the following format : DD/MM/YYYY
                        </div>
                      </div>
                    </div>

                    <div class="form-group col-sm-12 col-lg-6">
                    <span [hidden]="!this.companyService.belgianCompanies.includes(this.company.value) || (!hasReadAllOrAdminRole && !hasReadAllOrAdminRole)">
                      <label class="label-ro" for="workerId">Worker ID</label>
                      <input
                        class="form-control"
                        formControlName="workerId"
                        id="workerId"
                        placeholder="Worker ID"
                        type="text"
                        maxlength="100"
                      />
                      <div *ngIf="workerId.invalid && (workerId.dirty || workerId.touched)" class="invalid-feedback">
                        <div *ngIf="workerId.errors?.maxlength">
                          Worker ID size must not exceed 100 characters
                        </div>
                      </div>
                    </span>
                    </div>

                    <div class="form-group col-sm-12 col-lg-4">
                      <label class="label-ro">Contract type
                        <small class="text-muted">(required)</small>
                      </label>
                      <div  class="mt-1 pt-1">
                        <div class="custom-control custom-radio custom-control-inline">
                          <input (change)="handleChangeContractType($event)" class="custom-control-input"
                                 formControlName="contractTypeRadio" id="fullTime" mdbInput
                                 name="contractTypeRadio" type="radio" value="fullTime">
                          <label class="custom-control-label" for="fullTime">Full time</label>
                        </div>
                        <div class="custom-control custom-radio custom-control-inline">
                          <input (change)="handleChangeContractType($event)" class="custom-control-input"
                                 formControlName="contractTypeRadio" id="partTime" mdbInput
                                 name="contractTypeRadio" type="radio" value="partTime">
                          <label class="custom-control-label" for="partTime">Part time</label>
                        </div>
                      </div>
                    </div>

                    <div class="form-group col-sm-0 col-lg-4">
                      <label for="partTimePercentage" style="color: transparent;">Percentage</label>
                      <div class="input-group">
                        <input class="form-control" formControlName="workPercentage" id="partTimePercentage"
                               max="100"
                               min="0" name="landline" type="number"/>
                        <div class="input-group-append">
                          <span class="input-group-text"><span style="width: 1rem">%</span></span>
                        </div>
                      </div>
                    </div>

                    <div class="form-group col-sm-0 col-lg-4">
                      <ng-container *ngIf="this.companyService.belgianCompanies.includes(this.company.value) && this.EMPLOYEE_AND_OVERHEAD.includes(this.type.value)">
                        <label for="workingTime">Working time</label>
                        <select class="form-control custom-select" formControlName="workingTime" id="workingTime"
                                name="workingTime">
                          <option *ngFor="let workingTime of this.WORKING_TIME_LIST" [value]="workingTime">
                            {{workingTime}}
                          </option>
                        </select>
                      </ng-container>
                    </div>

                    <ng-template #rtJobPosition let-r="result" let-t="term">
                      <ngb-highlight [result]="r" [term]=""></ngb-highlight>
                    </ng-template>

                    <div class="form-group col-sm-12 col-lg-6">
                      <app-job-position-select [jobPositions]="formData.jobpositions"
                                               [control]="jobPosition">
                      </app-job-position-select>
                    </div>

                    <ng-template #rtJobTitle let-r="result" let-t="term">
                      <ngb-highlight [result]="r" [term]=""></ngb-highlight>
                    </ng-template>
                    <div class="form-group col-sm-12 col-lg-6">
                      <label class="label-ro" for="jobTitle">Job title</label>
                      <input
                        #instanceJobTitle="ngbTypeahead"
                        (click)="clickJobTitle$.next($event.target.value)"
                        [inputFormatter]="formatterString"
                        [ngbTypeahead]="searchJobTitle"
                        [resultTemplate]="rtJobTitle"
                        class="form-control"
                        formControlName="jobTitle"
                        id="jobTitle"
                        placeholder="Job title"
                        type="text"
                        maxlength="256"
                      />
                      <div *ngIf="jobTitle.invalid && (jobTitle.dirty || jobTitle.touched)" class="invalid-feedback">
                        <div *ngIf="jobTitle.errors?.maxlength">
                          Job title size must not exceed 255 characters
                        </div>
                      </div>
                    </div>

                    <div class="form-group col-sm-12 col-lg-6">
                      <label></label>
                      <div class="form-check">
                        <input class="form-check-input" id="arhsAccountNecessary" name="arhsAccountNecessary"
                               formControlName="accountNecessary" type="checkbox">
                        <label for="arhsAccountNecessary">Phoenix account necessary</label>
                      </div>
                    </div>

                    <div class="form-group col-sm-12 col-lg-6">
                      <label></label>
                      <div class="form-check">
                        <input class="form-check-input" id="arhsLaptopNecessary" name="arhsLaptopNecessary"
                               (change)="laptopNecessaryEvent($event)" formControlName="laptopNecessary"
                               type="checkbox"/>
                        <label for="arhsLaptopNecessary">Company laptop necessary</label>
                      </div>
                    </div>

                    <div class="form-group col-sm-12 col-lg-6">
                      <div class="form-check">
                        <input class="form-check-input" id="timesheetNotMandatory" name="timesheetNotMandatory"
                               formControlName="timesheetNotMandatory" type="checkbox"/>
                        <label for="timesheetNotMandatory">Timesheet not mandatory</label>
                      </div>
                    </div>
                    <div class="form-group col-sm-12 col-lg-6"></div>
                    <div class="form-group col-sm-12 col-lg-6">
                      <span [hidden]="!this.companyService.belgianCompanies.includes(this.company.value) || (!hasReadAllOrAdminRole && !hasReadAllOrAdminRole)">
                        <label class="label-ro" for="yearlyCePool">Number of contractual holidays (CE)</label>
                        <input
                          class="form-control"
                          formControlName="yearlyCePool"
                          id="yearlyCePool"
                          placeholder="Number of contractual holidays (CE)"
                          type="number"
                        />
                      </span>
                    </div>
                    <div class="col-12 p-0">
                      <ng-container *ngIf="this.hasReadAllOrAdminRole || hasReadAccessToResource || (this.hasAdminRole && isResourceAdministrated)">

                        <!-- Churn-->
                        <app-churn-candidate  *ngIf="checkChurn" [churn]="churnIn"
                                              (updateChurn)="updateChurn($event)"></app-churn-candidate>
                      </ng-container>
                    </div>

                  </ng-container>
                </form>
              </div>

            </div>
          </div>

          <div class="row">
            <div class="col-12 col-sm-6 pt-3 pt-sm-5">
              <header>
                <h2 class="mb-3">Work Permit Information</h2>
              </header>
              <div class="p-3">
                <app-work-permit #workPermitComponent
                                 [today]="today"
                                 [isAdminOfCandidate]="isUserAdministrator"
                                 [workPermitIdNotRequired]="workPermitIdNotRequired"
                >
                </app-work-permit>
              </div>
              <div *ngIf="this.displayResidencePermitInfo">
                <header class="card-header card-header-lg card-header-full" style="margin-top: -3rem;">
                  <h2 class="card-title">Residence Permit Information</h2>
                </header>
                <div class="card-body">
                  <app-work-permit #residencePermitComponent
                                   [today]="today"
                                   [isAdminOfCandidate]="isUserAdministrator"
                                   [isResidencePermit]="true"
                  >
                  </app-work-permit>
                </div>
              </div>
            </div>
            <div class="col-12 col-sm-6 pt-3 pt-sm-5 border-left">
              <ng-container *ngIf="this.hasReadAllOrAdminRole || hasReadAccessToResource || (this.hasAdminRole && isResourceAdministrated)">
                <!-- Customer and Contract Information div -->

                <header>
                  <h2 class="mb-3">Customer & Contract Information</h2>
                </header>

                <div class="p-3">
                  <form [formGroup]="contractDetailsForm" class="row">
                    <ng-template #rtPartner let-r="result" let-t="term">
                      <ngb-highlight [result]="r" [term]=""></ngb-highlight>
                    </ng-template>
                    <div class="form-group col-sm-12 col-lg-6">
                      <label class="label-ro">Job partner </label>
                      <ng-select [items]="this.formData['partners']"
                                 formControlName="jobPartner"
                                 placeholder="Select a job partner"
                                 bindLabel="legalName" bindValue="partnerId">
                      </ng-select>
                      <div *ngIf="jobPartner.invalid && (jobPartner.dirty || jobPartner.touched)"
                           class="invalid-feedback">
                        <div *ngIf="jobPartner.errors?.maxlength">
                          Job partner size must not exceed 200 characters
                        </div>
                      </div>
                    </div>

                    <ng-template #rtDepartment let-r="result" let-t="term">
                      <ngb-highlight [result]="r" [term]=""></ngb-highlight>
                    </ng-template>
                    <div class="form-group col-sm-12 col-lg-6">
                      <label class="label-ro" for="contractDepartment">Department</label>
                      <input
                        #instanceDepartment="ngbTypeahead"
                        (click)="clickDepartment$.next($event.target.value)"
                        [inputFormatter]="formatterString"
                        [ngbTypeahead]="searchDepartment"
                        [resultTemplate]="rtDepartment"
                        class="form-control"
                        formControlName="contractDepartment"
                        id="contractDepartment"
                        placeholder="Department"
                        type="text"
                        maxlength="31"
                      />
                      <div *ngIf="department.invalid && (department.dirty || department.touched)"
                           class="invalid-feedback">
                        <div *ngIf="department.errors?.maxlength">
                          Department size must not exceed 30 characters
                        </div>
                      </div>
                    </div>
                  </form>
                  <form [formGroup]="customerAndContractInformationForm" action="#" class="row">

                    <ng-template #rtCustomer let-r="result" let-t="term">
                      <ngb-highlight [result]="r" [term]=""></ngb-highlight>
                    </ng-template>
                    <div class="form-group col-sm-12 col-lg-6">
                      <label for="customer">Customer</label>
                      <input
                        #instanceCustomer="ngbTypeahead"
                        (click)="clickCustomer$.next($event.target.value)"
                        [inputFormatter]="formatterString"
                        [ngbTypeahead]="searchCustomer"
                        [resultTemplate]="rtCustomer"
                        class="form-control"
                        formControlName="customer"
                        id="customer"
                        placeholder="Customer"
                        type="text"
                        maxlength="21"
                      />
                      <div *ngIf="customer.invalid && (customer.dirty || customer.touched)" class="invalid-feedback">
                        <div *ngIf="customer.errors?.maxlength">
                          Customer size must not exceed 20 characters
                        </div>
                      </div>
                    </div>

                    <ng-template #rtContract let-r="result" let-t="term">
                      <ngb-highlight [result]="r" [term]=""></ngb-highlight>
                    </ng-template>
                    <div class="form-group col-sm-12 col-lg-6">
                      <label for="contract">Contract</label>
                      <input
                        #instanceContract="ngbTypeahead"
                        (click)="clickContract$.next($event.target.value)"
                        [inputFormatter]="formatterString"
                        [ngbTypeahead]="searchContract"
                        [resultTemplate]="rtContract"
                        class="form-control"
                        formControlName="contract"
                        id="contract"
                        placeholder="Contract"
                        type="text"
                        maxlength="51"
                      />
                      <div *ngIf="contract.invalid && (contract.dirty || contract.touched)" class="invalid-feedback">
                        <div *ngIf="contract.errors?.maxlength">
                          Contract size must not exceed 50 characters
                        </div>
                      </div>
                    </div>

                  </form>
                </div>
              </ng-container>
            </div>
          </div>
        </div>


      </section>

      <!-- Tab Personal Usage Policy -->
      <section aria-labelledby="personal-usage-policy-tab" class="tab-pane fade" id="personal-usage-policy"
               role="tabpane2">

        <div class="box mx-0 pt-4">

            <header>
              <h2 class="mb-3">Personal usage policy</h2>
            </header>

            <div class="p-3">
              <form [formGroup]="personalUsagePolicyForm" action="#" class="row">
                <div class="form-group col-sm-12 col-lg-6">
                  <div class="form-check">
                    <input class="form-check-input" formControlName="showBirthDay"
                           name="showBirthdayTool"
                           id="showBirthdayTool" type="checkbox">
                    <label for="showBirthdayTool">Show birthday information on tools (email included)</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" formControlName="showJobAnniversary" id="displayJobAnniversary"
                           name="displayJobAnniversary" type="checkbox">
                    <label for="displayJobAnniversary">Display job anniversary on Helios</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" formControlName="showUserPictureOnTools" id="displayUserPicture"
                           name="displayUserPicture" type="checkbox">
                    <label for="displayUserPicture">Display user picture on tools (email included)</label>
                  </div>
                </div>
              </form>
            </div>

        </div>

      </section>

      <!-- Tab contact -->
      <section aria-labelledby="contact-tab" class="tab-pane fade" id="contact" role="tabpane3">
        <div class="box mx-0 pt-4">
          <div>

            <header>
              <h2 class="mb-3">Personal contacts</h2>
            </header>

            <div class="p-3">
              <form [formGroup]="contactForm" action="#">
                <div class="row">
                  <div class="form-group col-sm-12 col-lg-4">
                    <label for="landline">Landline</label>
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text"><span class="fa fa-phone" style="width: 1rem"></span></span>
                      </div>
                      <input class="form-control" formControlName="landline" id="landline" name="landline"
                             maxlength="41" placeholder="Landline phone" type="text"/>
                    </div>
                    <div *ngIf="landline.invalid && (landline.dirty || landline.touched)"
                         class="invalid-feedback">
                      <div *ngIf="landline.errors?.maxlength">
                        Landline size must not exceed 40 characters
                      </div>
                    </div>
                  </div>

                  <div class="form-group col-sm-12 col-lg-4 ">
                    <label class="label-ro" for="instantMessenger">Instant messenger</label>
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text"><span class="fa-solid fa-bolt" style="width: 1rem"></span></span>
                      </div>
                      <input class="form-control" formControlName="messenger" id="instantMessenger"
                             name="instantMessenger"
                             maxlength="151" placeholder="Instant messenger" type="text"/>
                    </div>
                    <div *ngIf="messenger.invalid && (messenger.dirty || messenger.touched)"
                         class="invalid-feedback">
                      <div *ngIf="messenger.errors?.maxlength">
                        Instant messenger size must not exceed 150 characters
                      </div>
                    </div>
                  </div>

                  <div class="form-group col-sm-12 col-lg-4">
                    <label class="label-ro" for="customerMail">Customer email</label>
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text"><span class="fa fa-envelope" style="width: 1rem"></span></span>
                      </div>
                      <input class="form-control" formControlName="customerMail"
                             id="customerMail" placeholder="Customer email"
                             maxlength="61" name="customerMail" type="text"/>
                    </div>
                    <div *ngIf="customerMail.invalid && (customerMail.dirty || customerMail.touched)"
                         class="invalid-feedback">
                      <div *ngIf="customerMail.errors?.maxlength">
                        Customer mail size must not exceed 60 characters
                      </div>
                    </div>
                  </div>

                  <div class="form-group col-sm-12 col-lg-4">
                    <label class="label-ro" for="mobile">Mobile</label>
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text"><span class="fa fa-mobile" style="width: 1rem"></span></span>
                      </div>
                      <input class="form-control" formControlName="mobile"
                             id="mobile" maxlength="41" name="mobile" placeholder="Mobile phone" type="text"/>
                    </div>
                    <div *ngIf="mobile.invalid && (mobile.dirty || mobile.touched)"
                         class="invalid-feedback">
                      <div *ngIf="mobile.errors?.maxlength">
                        Mobile size must not exceed 40 characters
                      </div>
                    </div>
                  </div>

                  <div class="form-group col-sm-12 col-lg-4">
                    <label class="label-ro" for="proMail">Professional email</label>
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text"><span class="fa fa-envelope" style="width: 1rem"></span></span>
                      </div>
                      <input class="form-control" formControlName="proMail"
                             id="proMail" maxlength="61"
                             name="proMail" placeholder="Professional email" type="text"/>
                    </div>
                    <div *ngIf="proMail.invalid && (proMail.dirty || proMail.touched)"
                         class="invalid-feedback">
                      <div *ngIf="proMail.errors?.maxlength">
                        Professional mail size must not exceed 60 characters
                      </div>
                    </div>
                  </div>
                </div>
              </form>

            </div>

          </div>
        </div>
      </section>

      <!-- Tab emergency contact -->
      <section aria-labelledby="emergency-contact-tab" class="tab-pane fade" id="emergency-contact" role="tabpane3"
               *ngIf="isResourceAdministrated">
        <div class="box mx-0 pt-4">
          <header>
            <h2 class="mb-3">Emergency contacts</h2>
          </header>

          <div class="p-3">
            <form *ngIf="isResourceAdministrated" [formGroup]="emergencyContactForm" action="#">
              <div class="form-group row mb-0">
                <div class="form-group col-sm-12 col-lg-6 pr-4 mb-0">
                  <h3>Contact 1</h3>
                  <div class="form-group">
                    <label class="label-ro" for="contact1FullName">Full name</label>
                    <input class="form-control" formControlName="fullNameContact1" id="contact1FullName"
                           maxlength="51" name="contact1FullName" placeholder="Full name" type="text">
                    <div *ngIf="fullNameContact1.invalid && (fullNameContact1.dirty || fullNameContact1.touched)"
                         class="invalid-feedback">
                      <div *ngIf="fullNameContact1.errors?.maxlength">
                        Full name size must not exceed 50 characters
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="label-ro" for="relationShipContact1">Relationship</label>
                    <input class="form-control" formControlName="relationshipContact1" id="relationShipContact1"
                           name="relationShipContact1" placeholder="Relationship"
                           maxlength="60" type="text">
                    <div
                      *ngIf="relationshipContact1.invalid && (relationshipContact1.dirty || relationshipContact1.touched)"
                      class="invalid-feedback">
                      <div *ngIf="relationshipContact1.errors?.maxlength">
                        Relationship size must not exceed 60 characters
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="label-ro" for="phoneContact1">Phone number</label>
                    <input class="form-control" formControlName="phoneNumberContact1" id="phoneContact1"
                           maxlength="41" name="phoneContact1" placeholder="Phone number" type="text">
                    <div
                      *ngIf="phoneNumberContact1.invalid && (phoneNumberContact1.dirty || phoneNumberContact1.touched)"
                      class="invalid-feedback">
                      <div *ngIf="phoneNumberContact1.errors?.maxlength">
                        Phone number size must not exceed 40 characters
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-group col-sm-12 col-lg-6 pl-4 border-left mb-0">
                  <h3>Contact 2</h3>
                  <div class="form-group">
                    <label class="label-ro" for="contact2FullName">Full name</label>
                    <input class="form-control" formControlName="fullNameContact2" id="contact2FullName"
                           maxlength="51" name="contact2FullName" placeholder="Full name" type="text">
                    <div *ngIf="fullNameContact2.invalid && (fullNameContact2.dirty || fullNameContact2.touched)"
                         class="invalid-feedback">
                      <div *ngIf="fullNameContact2.errors?.maxlength">
                        Full name size must not exceed 50 characters
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="label-ro" for="relationShipContact2">Relationship</label>
                    <input class="form-control" formControlName="relationshipContact2" id="relationShipContact2"
                           name="relationShipContact2" placeholder="Relationship"
                           maxlength="60" type="text">
                    <div *ngIf="relationshipContact2.invalid && (relationshipContact2.dirty ||
                    relationshipContact2.touched)"
                         class="invalid-feedback">
                      <div *ngIf="relationshipContact1.errors?.maxlength">
                        Relationship size must not exceed 60 characters
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="label-ro" for="phoneContact2">Phone number</label>
                    <input class="form-control" formControlName="phoneNumberContact2" id="phoneContact2"
                           name="phoneContact2" placeholder="Phone number" type="text">
                    <div *ngIf="phoneNumberContact2.invalid && (phoneNumberContact2.dirty ||
                    phoneNumberContact2.touched)"
                         class="invalid-feedback">
                      <div *ngIf="phoneNumberContact2.errors?.maxlength">
                        Phone number size must not exceed 40 characters
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-group row mb-0">
                <div class="form-group col">
                  <label for="contactComment">Comment</label>
                  <textarea class="form-control" formControlName="contactComment" id="contactComment" maxlength="1000"
                            name="contactComment" placeholder="Comment" rows="4"></textarea>
                </div>
              </div>
            </form>
          </div>
        </div>
      </section>

      <!-- Tab security clearance -->
      <section *ngIf="this.hasReadAllOrAdminRole || isResourceAdministrated" aria-labelledby="security-clearance-tab" class="tab-pane fade"
               id="security-clearance" role="tabpane4">
        <div class="box mx-0 pt-4">

            <header>
              <h2 class="mb-3">Security clearance</h2>
            </header>

            <div class="p-3">
              <div>
                <table
                  class="table table-striped table-layout-fixed table-head-sticky table-hover">
                  <thead>
                  <tr>
                    <th></th>
                     <th *ngFor="let level of formData.securityLevels"
                        class="text-center">{{level | convertUnderscoreToSpace | titlecase}}</th>
                    <th></th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr *ngFor="let organization of organizationList" style="height: 7vh;">
                    <td style="max-width: 13rem;">{{ organization }}</td>
                    <td *ngFor="let levelRow of getCorrespondingLine(organization)">
                      <div class="d-flex align-items-center justify-content-center">
                        <div class="form-check">
                          <input (change)="checkOrganization(levelRow)" [checked]="levelRow.checked"
                                 class="form-check-input" id="mapAll-{{levelRow.organization}}-{{levelRow.level}}"
                                 [disabled]="!isResourceAdministrated" type="checkbox">
                          <label class="form-check-label" for="mapAll-{{levelRow.organization}}-{{levelRow.level}}">
                            &nbsp;
                          </label>
                        </div>
                      </div>
                    </td>
                    <td class="text-right">
                      <button (click)="deleteOrganization(organization)"
                              *ngIf="(isResourceAdministrated)&& !STATIC_ORGANISATION.includes(organization)"
                              class="btn  btn-basic btn-icon">
                        <i class="fas fa-trash"></i>
                      </button>
                    </td>
                  </tr>
                  <tr *ngIf="isResourceAdministrated" [formGroup]="securityCleranceForm">
                    <td style="background-color: #f4f5f5;">
                      <input
                        formControlName="organizationName"
                        class="form-control"
                        id="organization" maxlength="50" style="max-width: 10rem;" type="text"/>
                    </td>
                    <td *ngFor="let securityLevel of formData.securityLevels" style="background-color: #f4f5f5;">
                      <div class="d-flex align-items-center justify-content-center">
                        <div class="form-check">
                          <input [disabled]="!isResourceAdministrated"
                                 class="form-check-input" formControlName="{{securityLevel}}"
                                 id="add-{{securityLevel}}" type="checkbox">
                          <label class="form-check-label" for="add-{{securityLevel}}">
                            &nbsp;
                          </label>
                        </div>
                      </div>
                    </td>
                    <td class="text-right" style="background-color: #f4f5f5;">
                      <button (click)="addOrganization()"
                              [disabled]="(!isResourceAdministrated) || this.securityCleranceForm.invalid"
                              class="btn  btn-primary btn-icon">
                        <i class="fa fa-plus"></i>
                      </button>
                    </td>
                  </tr>
                  </tbody>
                </table>
                <div *ngIf="this.alreadyExist" class="invalid-feedback">
                  An organization with the same name already exists
                </div>
              </div>
            </div>

        </div>
      </section>

      <!-- Tab onboarding -->
      <section aria-labelledby="onboarding" class="tab-pane fade" id="onboarding" role="tabpane5">
        <div class="box mx-0 pt-4">
          <header>
            <h2 class="mb-3">Onboarding</h2>
          </header>

          <div class="p-3">
            <app-responsible-at-arhs #responsibleAtArhsComponent
                                     [startDate]="startDate"
                                     [employeeList]="employeeList"
                                     [userToShow]="user"
                                     [isEditResource]="true">
            </app-responsible-at-arhs>
          </div>

        </div>
      </section>

      <!-- Tab badge -->
      <section *ngIf="onEdit === 'edit'" aria-labelledby="badge" class="tab-pane fade" id="badge" role="tabpane6">
        <div class="box mx-0 pt-4">

            <header>
              <h2 class="mb-3">Badge</h2>
            </header>

            <div class="p-3">
              <form [formGroup]="badgeForm">
                <div class="row align-items-end mb-4">
                  <div class="col-4">
                    <div class="row align-items-end">
                      <div class="col">
                        <label for="beaconId">Beacon ID</label>
                        <input [readOnly]="!isResourceAdministrated" class="form-control" formControlName="beaconId" id="beaconId"
                               placeholder="Beacon ID"
                               maxlength="255"
                               type="text">
                        <div *ngIf="beaconId.invalid && (beaconId.dirty || beaconId.touched)"
                             class="invalid-feedback">
                          <div *ngIf="beaconId.errors?.maxlength">
                            Beacon Id must not exceed 255 characters
                          </div>
                        </div>
                      </div>
                      <div class="col-auto">
                        <button class="btn btn-basic" type="button" style="margin-top: 2em;"
                                id="parkingNotification"
                                [disabled]="!beaconId.value"
                                (click)="notifyAvailableParkingPlace(user.account)">
                          Notify parking
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
                <hr>
                <div *ngIf="isResourceAdministrated" class="row align-items-end mt-2">
                  <div  class="col-4">
                    <div class="row align-items-end">
                      <div class="col">
                        <label for="badgeNumber">Badge number</label>
                        <ng-template #rtBadgeNumber let-r="result.badgeNumber" let-t="term">
                          <ngb-highlight [result]="r" [term]=""></ngb-highlight>
                        </ng-template>
                        <input #instanceBadgeNumber="ngbTypeahead"
                               (click)="clickBadgeNumber$.next($event.target.value)"
                               [ngbTypeahead]="searchBadgeNumber"
                               [inputFormatter]="formatterBadge"
                               class="form-control"
                               formControlName="badgeNumber"
                               type="text"
                               id="badgeNumber"
                               [resultTemplate]="rtBadgeNumber"/>
                      </div>
                      <div class="col-auto">
                        <button class="btn btn-primary" type="button" style="margin-top: 2em;"
                                [disabled]="!badgeNumber.value"
                                (click)="addToBadgeList()">
                          <i class="fa fa-plus"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="table-responsive" style="margin-top: 2em;">
                  <table class="table table-full">
                    <thead>
                    <tr>
                      <th scope="col"><span (click)="changeSort()" class="sort-column"> Badge number  <i
                        class="fas {{sortAscending?'fa-sort-up':'fa-sort-down'}}"
                      ></i></span></th>
                      <th scope="col" *ngFor="let access of accessTypes;" >
                        <span>{{access}}</span>
                      </th>
                      <th class="text-right" scope="col"></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr *ngFor="let badge of badges">
                      <td>{{badge.badgeNumber}}</td>
                      <td *ngFor="let access of accessTypes">
                        <div class="form-check" (click)="toggleBadgeAccessType(badge, access)">
                          <input class="form-check-input"
                                 [disabled]="!isResourceAdministrated"
                                 [checked]="isAccessChecked(badge, access)"
                                 type="checkbox"/>
                          <label class="form-check-label" style="margin-bottom: 1em;"></label>
                          </div>
                      </td>
                      <td *ngIf="isResourceAdministrated" class="text-right pr-0 pl-0">
                        <button class="btn btn-sm btn-basic" type="button" (click)="removeBadge(badge)">
                          <i class="fa fa-trash"></i>
                        </button>
                      </td>
                    </tr>
                    </tbody>
                  </table>
                </div>

              </form>
            </div>

        </div>
      </section>
      <!-- Tab phone -->
      <section *ngIf="onEdit === 'edit'" aria-labelledby="phone" class="tab-pane fade" id="phone" role="tabpane6">
        <app-manage-phone-numbers [isUserAdministrator]="isResourceAdministrated" [user]="user"></app-manage-phone-numbers>
      </section>

      <section aria-labelledby="Frontier worker declaration" class="tab-pane fade" id="frontier" role="tabpane6">
        <app-frontier-worker-declaration [residentialCountry]="residentialCountry.value?.countryLabel"
                                         [socialSecurityNumber]="socialSecurityNumber.value"
                                         [userToShow]="user"
                                         [frontierDeclarationForm]="frontierDeclarationForm"
                                         [readOnly]="!isResourceAdministrated"
        >
        </app-frontier-worker-declaration>
      </section>
    </div>

  </div>
</section>

<!-- Modal for cropping -->
<div aria-hidden="true" aria-labelledby="cropImageTitle" class="modal fade" id="editProfilePicture"
     role="dialog" tabindex="-1">

  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title" id="cropImageTitle">Edit profile picture</h5>
        <button #exitButton (click)="cancelCropping()" aria-label="Close" class="close" data-dismiss="modal"
                type="button">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body d-flex align-items-center justify-content-center flex-column">
        <div style="height: 300px;" class="d-flex justify-content-center align-items-center">
          <image-cropper
            #cropperComponent
            (imageCropped)="imageCropped($event)"
            (imageLoaded)="imageLoaded()"
            (cropperReady)="cropperReady()"
            [alignImage]="'center'"
            [imageChangedEvent]="imageChangedEvent"
            [aspectRatio]="1"
            [maintainAspectRatio]="true"
            [format]="'jpeg'"
            outputType="base64">
          </image-cropper>
        </div>

        <div>
          <button (click)="rotateLeft()" class="btn btn-basic btn-sm mr-1"><i class="fa fa-undo" aria-hidden="true"></i></button>
          <button (click)="rotateRight()" class="btn btn-basic btn-sm"><i class="fa fa-repeat" aria-hidden="true"></i></button>
        </div>
      </div>

      <div class="modal-footer">
          <button (click)="cancelCropping()" class="btn btn-link" data-dismiss="modal" type="button">Cancel</button>
          <button (click)="setCroppedAsUserPic()" class="btn btn-primary" data-dismiss="modal" type="button">Apply
          </button>
      </div>

    </div>
  </div>

</div>
